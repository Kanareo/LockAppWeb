{"version":3,"file":"js/919.bf9c9ede.js","mappings":"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","sources":["webpack://vue-app/./src/components/WebAuth.vue","webpack://vue-app/./src/components/WebAuth.vue?69fb"],"sourcesContent":["<template>\r\n  <MainLayout>\r\n    <div class=\"content\">\r\n      <div class=\"wrapper\">\r\n        <div class=\"center\">\r\n          <form @submit.prevent=\"selectLock\">\r\n            <select v-model=\"selected\">\r\n              <option disabled value=\"\">Select lock</option>\r\n              <option v-for=\"item in this.locks\" :key=\"item.key\">\r\n                {{ item.ID }}\r\n              </option>\r\n            </select>\r\n          </form>\r\n          <div v-if=\"selected != ''\" class=\"auth-content\">\r\n            <h2>LockAuth</h2>\r\n            <button @click=\"authorizeAccess\" class=\"btn btn-secondary\">\r\n              Authorize access\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <Teleport to=\"body\">\r\n      <Message\r\n        :messageType=\"messageType\"\r\n        :show=\"showMessage\"\r\n        :message=\"messageContent\"\r\n        :closeMessage=\"closeMessage\"\r\n      />\r\n    </Teleport>\r\n  </MainLayout>\r\n</template>\r\n\r\n<script>\r\nimport DataService from \"../services/DataService\";\r\nimport { onValue, get } from \"firebase/database\";\r\nimport moment from \"moment\";\r\nimport Message from \"./Message\";\r\nimport MainLayout from \"./MainLayout\";\r\nexport default {\r\n  name: \"LockSim\",\r\n  components: { Message, MainLayout },\r\n  data() {\r\n    return {\r\n      locks: [],\r\n      selected: \"\",\r\n      showMessage: false,\r\n      messageType: \"\",\r\n      messageContent: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    printMessage(type, message) {\r\n      this.showMessage = true;\r\n      this.messageType = type;\r\n      this.messageContent = message;\r\n    },\r\n    closeMessage() {\r\n      this.showMessage = false;\r\n    },\r\n    onDataChange(items) {\r\n      let _locks = [];\r\n      items.forEach((item) => {\r\n        _locks.push({\r\n          ID: item.key,\r\n        });\r\n      });\r\n      this.locks = _locks;\r\n    },\r\n    checkTime(auth) {\r\n      let lockAuth = auth.val();\r\n      let time = moment().format(\"LLL\");\r\n      let minutes = moment(time, \"LLL\").diff(\r\n        moment(lockAuth, \"LLL\"),\r\n        \"minutes\"\r\n      );\r\n      if (minutes <= 1 && minutes >= -1) {\r\n        this.sendAuthorization();\r\n      } else {\r\n        this.clearAuthorization();\r\n      }\r\n    },\r\n    authorizeAccess() {\r\n      let data;\r\n      // onValue(\r\n      //   DataService.getFromPath(\"/locks/\" + this.selected + \"/auth/lock\"),\r\n      //   (snapshot) => {\r\n      //     data = snapshot;\r\n      //     if (this.checkAuth(data)) {\r\n      //       this.checkTime(data);\r\n      //       return;\r\n      //     } else {\r\n      //       this.printMessage(\"warning\", \"Wait for user first!\");\r\n      //       return;\r\n      //       //alert(\"Wait for user first!\");\r\n      //     }\r\n      //   }\r\n      // );\r\n      get(\r\n        DataService.getFromPath(\"/locks/\" + this.selected + \"/auth/lock\")\r\n      ).then((snapshot) => {\r\n        if (snapshot.exists()) {\r\n          data = snapshot;\r\n          if (this.checkAuth(data)) {\r\n            this.checkTime(data);\r\n            return;\r\n          } else {\r\n            this.printMessage(\"warning\", \"Wait for user first!\");\r\n            return;\r\n            //alert(\"Wait for user first!\");\r\n          }\r\n        }\r\n      });\r\n    },\r\n    checkAuth(auth) {\r\n      // if (auth == null) {\r\n      //   return false;\r\n      // }\r\n      let _auth = auth.val();\r\n      if (_auth == \"\" || _auth == null) {\r\n        return false;\r\n      } else {\r\n        return true;\r\n      }\r\n    },\r\n    sendAuthorization() {\r\n      const update = {};\r\n      update[\"/locks/\" + this.selected + \"/auth/unlocked\"] = true;\r\n      update[\"/locks/\" + this.selected + \"/auth/lock\"] = \"\";\r\n      DataService.update(update)\r\n        .then(() => {\r\n          this.printMessage(\"success\", \"User authorized\");\r\n          //alert(\"User authorized\");\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n          this.printMessage(\r\n            \"danger\",\r\n            \"Error occured, report it to administrator!\"\r\n          );\r\n          //alert(\"There was error, report to administrator\");\r\n        });\r\n    },\r\n    clearAuthorization() {\r\n      const update = {};\r\n      update[\"/locks/\" + this.selected + \"/auth/unlocked\"] = false;\r\n      update[\"/locks/\" + this.selected + \"/auth/lock\"] = \"\";\r\n      DataService.update(update)\r\n        .then(() => {\r\n          this.printMessage(\"warning\", \"Time difference is too great!\");\r\n          //alert(\"Time difference is too great!\");\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n          this.printMessage(\r\n            \"danger\",\r\n            \"Error occured, report it to administrator!\"\r\n          );\r\n          //alert(\"There was error, report to administrator\");\r\n        });\r\n    },\r\n  },\r\n  mounted() {\r\n    let data;\r\n    // onValue(DataService.getAllLocks(), (snapshot) => {\r\n    //   data = snapshot;\r\n    //   this.onDataChange(data);\r\n    // });\r\n    onValue(DataService.getFromPath(\"/locksList\"), (snapshot) => {\r\n      data = snapshot;\r\n      this.onDataChange(data);\r\n    });\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\nul {\r\n  list-style-type: none;\r\n  padding: 0;\r\n}\r\nli {\r\n  display: inline-block;\r\n  margin: 0 10px;\r\n}\r\na {\r\n  color: #42b983;\r\n}\r\n.content {\r\n  overflow-y: auto;\r\n  display: flex;\r\n}\r\n\r\n.wrapper {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 100%;\r\n  margin: 1rem;\r\n  padding: 1rem;\r\n  gap: 1rem;\r\n  background-color: #b1b1b1;\r\n  border-radius: 0.5rem;\r\n  overflow-y: auto;\r\n  box-shadow: 0px -1px 10px 4px #141414a6;\r\n}\r\n.center {\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  flex-direction: column;\r\n  border-radius: 0.5rem;\r\n  background-color: #ffffffb0;\r\n  padding: 1.5rem;\r\n}\r\n.auth-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n}\r\n</style>\r\n","import { render } from \"./WebAuth.vue?vue&type=template&id=a5874fd6&scoped=true\"\nimport script from \"./WebAuth.vue?vue&type=script&lang=js\"\nexport * from \"./WebAuth.vue?vue&type=script&lang=js\"\n\nimport \"./WebAuth.vue?vue&type=style&index=0&id=a5874fd6&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\Teczka Michała J\\\\Studia\\\\Inżynierka\\\\vue-app\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-a5874fd6\"]])\n\nexport default __exports__"],"names":["class","_createElementVNode","disabled","value","_createBlock","_component_MainLayout","onSubmit","_ctx","$data","$event","_hoisted_4","_createElementBlock","_Fragment","_renderList","locks","item","key","ID","_hoisted_6","onClick","$options","_Teleport","to","_createVNode","_component_Message","messageType","show","message","closeMessage","name","components","Message","MainLayout","data","selected","showMessage","messageContent","methods","printMessage","type","this","onDataChange","items","_locks","forEach","push","checkTime","auth","lockAuth","val","time","moment","format","minutes","diff","sendAuthorization","clearAuthorization","authorizeAccess","get","DataService","then","snapshot","exists","checkAuth","_auth","update","catch","error","console","log","mounted","onValue","__exports__","render"],"sourceRoot":""}