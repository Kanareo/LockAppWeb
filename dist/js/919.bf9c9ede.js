"use strict";(self["webpackChunkvue_app"]=self["webpackChunkvue_app"]||[]).push([[919],{2128:function(e,s,t){t.r(s),t.d(s,{default:function(){return _}});var o=t(3396),a=t(9242),c=t(7139);const n=e=>((0,o.dD)("data-v-a5874fd6"),e=e(),(0,o.Cn)(),e),i={class:"content"},l={class:"wrapper"},r={class:"center"},h=n((()=>(0,o._)("option",{disabled:"",value:""},"Select lock",-1))),u={key:0,class:"auth-content"},d=n((()=>(0,o._)("h2",null,"LockAuth",-1)));function g(e,s,t,n,g,k){const p=(0,o.up)("Message"),m=(0,o.up)("MainLayout");return(0,o.wg)(),(0,o.j4)(m,null,{default:(0,o.w5)((()=>[(0,o._)("div",i,[(0,o._)("div",l,[(0,o._)("div",r,[(0,o._)("form",{onSubmit:s[1]||(s[1]=(0,a.iM)(((...s)=>e.selectLock&&e.selectLock(...s)),["prevent"]))},[(0,o.wy)((0,o._)("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>g.selected=e)},[h,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.locks,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.key},(0,c.zw)(e.ID),1)))),128))],512),[[a.bM,g.selected]])],32),""!=g.selected?((0,o.wg)(),(0,o.iD)("div",u,[d,(0,o._)("button",{onClick:s[2]||(s[2]=(...e)=>k.authorizeAccess&&k.authorizeAccess(...e)),class:"btn btn-secondary"}," Authorize access ")])):(0,o.kq)("",!0)])])]),((0,o.wg)(),(0,o.j4)(o.lR,{to:"body"},[(0,o.Wm)(p,{messageType:g.messageType,show:g.showMessage,message:g.messageContent,closeMessage:k.closeMessage},null,8,["messageType","show","message","closeMessage"])]))])),_:1})}var k=t(2393),p=t(1178),m=t(6797),M=t.n(m),f=t(6170),w=t(5871),v={name:"LockSim",components:{Message:f.Z,MainLayout:w.Z},data(){return{locks:[],selected:"",showMessage:!1,messageType:"",messageContent:""}},methods:{printMessage(e,s){this.showMessage=!0,this.messageType=e,this.messageContent=s},closeMessage(){this.showMessage=!1},onDataChange(e){let s=[];e.forEach((e=>{s.push({ID:e.key})})),this.locks=s},checkTime(e){let s=e.val(),t=M()().format("LLL"),o=M()(t,"LLL").diff(M()(s,"LLL"),"minutes");o<=1&&o>=-1?this.sendAuthorization():this.clearAuthorization()},authorizeAccess(){let e;(0,p.U2)(k.Z.getFromPath("/locks/"+this.selected+"/auth/lock")).then((s=>{if(s.exists())return e=s,this.checkAuth(e)?void this.checkTime(e):void this.printMessage("warning","Wait for user first!")}))},checkAuth(e){let s=e.val();return""!=s&&null!=s},sendAuthorization(){const e={};e["/locks/"+this.selected+"/auth/unlocked"]=!0,e["/locks/"+this.selected+"/auth/lock"]="",k.Z.update(e).then((()=>{this.printMessage("success","User authorized")})).catch((e=>{console.log(e),this.printMessage("danger","Error occured, report it to administrator!")}))},clearAuthorization(){const e={};e["/locks/"+this.selected+"/auth/unlocked"]=!1,e["/locks/"+this.selected+"/auth/lock"]="",k.Z.update(e).then((()=>{this.printMessage("warning","Time difference is too great!")})).catch((e=>{console.log(e),this.printMessage("danger","Error occured, report it to administrator!")}))}},mounted(){let e;(0,p.jM)(k.Z.getFromPath("/locksList"),(s=>{e=s,this.onDataChange(e)}))}},L=t(89);const y=(0,L.Z)(v,[["render",g],["__scopeId","data-v-a5874fd6"]]);var _=y}}]);
//# sourceMappingURL=919.bf9c9ede.js.map